<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:th="http://www.thymeleaf.org"
	  xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
>
<head>
	<meta charset="UTF-8" />
	<meta name="viewport"
		  content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />

	<th:block th:fragment="css">

		<link rel="shortcut icon"
			  th:href="@{/resources/static/img/favicon.ico}" type="image/x-icon">
		<link rel="icon" th:href="@{/resources/static/img/favicon.ico}"
			  type="image/x-icon">

		<link rel="stylesheet"
			  th:href="@{https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css}">
		<link th:href="@{/resources/static/css/bootstrap.css}" rel="stylesheet"
			  type="text/css" />
		<link rel="stylesheet" type="text/css" th:href="@{/css/style.css}" />

		<!--Date picker range ako bude trebalo-->
		<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />

	</th:block>
</head>
<body>

<th:block th:fragment="header">
	<nav class="navbar navbar-expand-lg fixed-top navbar-dark bg-dark">
		<a class="navbar-brand" th:href="@{/}" style="margin-left: 3%"> <img
				src="/resources/static/img/logo.png"
				style="width: 80px; margin: -12px 7px 0px 0px;" /> <span th:text="#{msg.nav.home}"></span>
		</a>
		<button class="navbar-toggler" type="button" data-toggle="collapse"
				data-target="#navbarSupportedContent"
				aria-controls="navbarSupportedContent" aria-expanded="false"
				aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>

		<div class="collapse navbar-collapse" id="navbarSupportedContent">
			<ul class="navbar-nav mr-auto">
				<li class="nav-item"><a class="nav-link" th:href="@{/offer/search}"><span th:text="#{msg.nav.offers}"></span><span
						class="sr-only">(current)</span></a></li>
				<li class="nav-item" sec:authorize="hasAnyRole('ROLE_ADMIN, ROLE_PROVIDER')" >
					<a class="nav-link" th:href="@{/offer/new}">
						<span th:text="#{msg.nav.newOffer}"></span>
						<span class="sr-only">(current)</span>
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" th:href="@{/about}" th:text="#{msg.nav.about}"></a>
				</li>
				<li class="nav-item">
					<a class="nav-link" th:href="@{/contact}" th:text="#{msg.nav.contact}"></a>
				</li>
			</ul>
			<ul class="navbar-nav my-2 my-lg-0" >

                <!-- Language selection -->
                <li class="nav-item" style="padding: 5px 20px 0 10px">
                    <form class="btn-group btn-group-toggle" id="languages" data-toggle="buttons">
                        <label class="btn btn-sm btn-secondary" th:classappend="${#locale.language == 'hr'} ? 'active' : '' ">
                            <input type="radio" name="language" value="hr" th:checked="${#locale.language == 'hr'}">
                            <img style="height: 10px" src="/resources/static/img/flags/hr.png"/> <small th:text="#{msg.lang.hr}" class="text-uppercase"></small>
                        </label>
                        <label class="btn btn-sm btn-secondary" th:classappend="${#locale.language == 'en'} ? 'active' : '' ">
                            <input type="radio" name="language" id="en" autocomplete="off" value="en" th:checked="${#locale.language == 'en'}">
                            <img style="height: 10px" src="/resources/static/img/flags/en.png"/> <small th:text="#{msg.lang.en}" class="text-uppercase"></small>
                        </label>
                        <label class="btn btn-sm btn-secondary" th:classappend="${#locale.language == 'de'} ? 'active' : '' ">
                            <input type="radio" name="language" id="de" autocomplete="off" value="de" th:checked="${#locale.language == 'de'}">
                            <img style="height: 10px" src="/resources/static/img/flags/de.png"/> <small th:text="#{msg.lang.de}" class="text-uppercase"></small>
                        </label>
                        <label class="btn btn-sm btn-secondary" th:classappend="${#locale.language == 'it'} ? 'active' : '' ">
                            <input type="radio" name="language" id="it" autocomplete="off" value="it" th:checked="${#locale.language == 'it'}">
                            <img style="height: 10px" src="/resources/static/img/flags/it.jpg"/> <small th:text="#{msg.lang.it}" class="text-uppercase"></small>
                        </label>
                        <label class="btn btn-sm btn-secondary" th:classappend="${#locale.language == 'sr'} ? 'active' : '' ">
                            <input type="radio" name="language" id="sr" autocomplete="off" value="sr" th:checked="${#locale.language == 'sr'}">
                            <img style="height: 10px" src="/resources/static/img/flags/sr.png"/> <small th:text="#{msg.lang.sr}" class="text-uppercase"></small>
                        </label>
                    </form>
                </li>

                <li th:if="${registerView == null}" class="nav-item" sec:authorize="isAnonymous()"><a
                        class="nav-link" th:href="@{/register}" th:text="#{msg.register}"></a>
                </li>
                <li th:if="${loginView == null}" class="nav-item" sec:authorize="isAnonymous()"><a
                        class="nav-link" th:href="@{/login}" th:text="#{msg.login}"></a>
                </li>

				<li class="nav-item dropdown" sec:authorize="isAuthenticated()" style="padding-right: 50px">
					<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown"
					   role="button" data-toggle="dropdown" aria-haspopup="true"
					   aria-expanded="false"><strong sec:authentication="name"></strong></a>
					<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
						<a class="dropdown-item" href="#" sec:authorize="!hasAnyRole('ROLE_PROVIDER')">
							<i class="fa fa-pencil-square"></i> <span th:text="#{msg.nav.myReservations}"></span>
						</a>
						<a class="dropdown-item" th:href="@{/offer/myOffers}" sec:authorize="hasAnyRole('ROLE_ADMIN, ROLE_PROVIDER')">
							<i class="fa fa-opencart"></i> <span th:text="#{msg.nav.myOffers}"></span>
						</a>
						<a class="dropdown-item" th:href="@{/profile/me}" sec:authorize="hasRole('ROLE_USER')">
							<i class="fa fa-user"></i> <span th:text="#{msg.nav.myProfile}"></span>
						</a>
						<a class="dropdown-item" th:href="@{/profile/edit}" sec:authorize="hasRole('ROLE_USER')">
							<i class="fa fa-pencil"></i> <span th:text="#{msg.nav.editProfile}"></span>
						</a>
						<div class="dropdown-divider"></div>
						<a class="dropdown-item" th:href="@{/logout}"><i class="fa fa-power-off"></i> <span th:text="#{msg.nav.logout}"></span></a>
					</div>
				</li>

			</ul>
		</div>
	</nav>
</th:block>

<th:block th:fragment="footer">
	<footer class="footer">
		<div class="container-fluid">
			<p class="text-center" style="margin-top: 30vh;">
				<th:block>by <span class="text-info" th:text="#{msg.footer.team}"></span>
				</th:block>
				&copy;
				<th:block th:text="${#dates.format(#dates.createNow(), 'yyyy')}"></th:block>
			</p>
		</div>
	</footer>
</th:block>

<th:block th:fragment="results">
	<div class="row justify-content-md-center" th:if="${offers != null}" style="padding-bottom: 40px">
		<div class="col-md-12">
			<div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="panel-title" th:text="${titleResults}"></h3>
					<span class="badge badge-secondary" th:if="${!#strings.isEmpty(searchOfferForm.category)}">
                        <span th:text="#{msg.search.category}"></span>: <span th:text="${searchOfferForm.category}"></span>
                    </span>
					<span class="badge badge-secondary" th:if="${!#strings.isEmpty(searchOfferForm.numOfPeople)}">
                        <span th:text="#{msg.search.numOfPeople}"></span>: <span th:text="${searchOfferForm.numOfPeople}"></span>
                    </span>
					<span class="badge badge-secondary" th:if="${!#strings.isEmpty(searchOfferForm.country)}">
                        <span th:text="#{msg.search.country}"></span>: <span th:text="${searchOfferForm.country}"></span>
                    </span>
					<span class="badge badge-secondary" th:if="${!#strings.isEmpty(searchOfferForm.city)}">
                        <span th:text="#{msg.search.city}"></span>: <span th:text="${searchOfferForm.city}"></span>
                    </span>
					<span class="badge badge-secondary" th:if="${!#strings.isEmpty(searchOfferForm.date)}">
                        <span th:text="#{msg.search.date}"></span>: <span th:text="${searchOfferForm.date}"></span>
                    </span>
					<br>
				</div>
				<br>

				<div class="panel-body">
					<div class="card-columns">
						<p th:if="${noResults}" th:text="#{msg.search.noResults}"></p>
						<div th:each="offer : ${offers}">
							<a style="color: black; text-decoration: none;" th:href="@{'/offer/details/' + ${offer.id}}">
								<div class="card md-4">
									<img class="card-img-top" th:src="${offer.offerPicture.base64String}" alt="Card image cap" style="height: 18rem;">
									<div class="card-body" style="height: 10rem;">
										<h4 class="card-title" th:text="${offer.name}"></h4>
										<p class="card-text text-left" th:text="${#strings.substring(offer.description,0,79) + '...'}" th:if="${#strings.length(offer.description) > 80}"></p>
										<p class="card-text text-left" th:text="${offer.description}" th:if="${#strings.length(offer.description) < 81}"></p>
									</div>
									<div class="card-footer">
										<a th:href="@{'/offer/details/' + ${offer.id}}" class="d-inline">
											<button type="button" class="btn btn-outline-info"><i class="fa fa-info"></i> <span th:text="#{msg.details}"></span></button></a>
										<p class="d-inline pull-right" th:text="${#numbers.formatDecimal(offer.pricePerPerson,2,0)} + ' kn'"></p>
									</div>
								</div>
							</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</th:block>

<th:block th:fragment="additionalScripts">

	<!-- <script th:src="@{/webjars/spin-js/2.1.0/spin.js}"></script> -->

	<script th:src="@{/resources/static/js/jquery-3.3.1.min.js}"
			type="text/javascript"></script>

	<script th:src="@{/resources/static/js/custom.js}"
			type="text/javascript"></script>

	<script th:src="@{/resources/static/js/bootstrap.js}"
			type="text/javascript"></script>

	<!-- Date picker range-->
	<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
	<script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
	<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>

</th:block>


<th:block th:fragment="formValidationScript">
	<script>
        // Example starter JavaScript for disabling form submissions if there are invalid fields
        (function() {
            'use strict';
            window
                .addEventListener(
                    'load',
                    function() {
                        // Fetch all the forms we want to apply custom Bootstrap validation styles to
                        var forms = document
                            .getElementsByClassName('needs-validation');
                        // Loop over them and prevent submission
                        var validation = Array.prototype.filter
                            .call(
                                forms,
                                function(form) {
                                    form
                                        .addEventListener(
                                            'submit',
                                            function(
                                                event) {
                                                if (form
                                                    .checkValidity() === false) {
                                                    event
                                                        .preventDefault();
                                                    event
                                                        .stopPropagation();
                                                }
                                                form.classList
                                                    .add('was-validated');
                                            },
                                            false);
                                });
                    }, false);
        })();
	</script>
</th:block>
<th:block th:fragment="newOfferScript">
	<script>
        // Example starter JavaScript for disabling form submissions if there are invalid fields
        (function() {
            'use strict';
            window
                .addEventListener(
                    'load',
                    function() {
                        // Fetch all the forms we want to apply custom Bootstrap validation styles to
                        var forms = document
                            .getElementsByClassName('needs-validation');
                        // Loop over them and prevent submission
                        var validation = Array.prototype.filter
                            .call(
                                forms,
                                function(form) {
                                    form
                                        .addEventListener(
                                            'submit',
                                            function(
                                                event) {
                                                if (form
                                                    .checkValidity() === false) {
                                                    event
                                                        .preventDefault();
                                                    event
                                                        .stopPropagation();
                                                }
                                                form.classList
                                                    .add('was-validated');
                                            },
                                            false);
                                });
                    }, false);
        })();
	</script>
</th:block>


</body>
</html>